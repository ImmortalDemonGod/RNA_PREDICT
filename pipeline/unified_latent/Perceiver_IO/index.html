
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../stageC/mp_nerf/">
      
      
        <link rel="next" href="../../Energy_Minimization_%26_Molecular_Dynamics_%28MD%29_for_RNA_Structure_Refinement/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Perceiver IO - rna_predict</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#emoji-if-you-have-further-questions-on-any-specific-domain-experiment-eg-details-on-optical-flow-ablations-or-the-precise-query-embeddings-in-kinetics-autoencoding-feel-free-to-ask-for-an-expanded-section" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="rna_predict" class="md-header__button md-logo" aria-label="rna_predict" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            rna_predict
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Perceiver IO
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="rna_predict" class="md-nav__button md-logo" aria-label="rna_predict" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    rna_predict
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/getting_started/windows_compatibility_plan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Windows Compatibility
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Best Practices
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Best Practices
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/best_practices/code_quality_best_practices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code Quality
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Testing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Testing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/best_practices/testing/test_coverage_strategy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Coverage Strategy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/best_practices/testing/progressive_coverage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Progressive Coverage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/best_practices/testing/test_generation_prompt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Test Generation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_3" id="__nav_2_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Debugging
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Debugging
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/best_practices/debugging/comprehensive_debugging_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Comprehensive Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Pipeline
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Pipeline
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Overview
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/core_framework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Framework
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/Integrated_RNA_3D_Prediction_Pipeline_Final_Comprehensive_Design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Comprehensive Design
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/full_pipeline_specification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Full Specification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/Multi_Stage_Implementation_Plan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multi-Stage Plan
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Integration
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Integration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/Integrated_RNA_3D_Prediction_Pipeline_Final_Comprehensive_Design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Design
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/full_pipeline_specification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Full Specification
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3" id="__nav_3_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Hydra Integration
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Hydra Integration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/hydra_integration/hydra_tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tutorial
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/hydra_integration/hydra_integration_gap_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gap Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/hydra_integration/hydra_integration_master_document/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Master Document
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3_4" id="__nav_3_2_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Components
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Components
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/hydra_integration/components/stageA/StageA_2D_Adjacency/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stage A
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/hydra_integration/components/stageB/StageB_Torsion_Pairwise/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stage B
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/hydra_integration/components/stageC/StageC_3D_Reconstruction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stage C
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/hydra_integration/components/stageD/StageD_Diffusion_Refinement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stage D
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/hydra_integration/components/unified_latent/UnifiedLatentMerger/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Unified Latent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Stage A
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Stage A
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stageA/StageA_RFold/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stageA/RFold_code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RFold Code
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stageA/RFold_paper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RFold Paper
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stageA/rfold-demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Demo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stageA/stage_a_extra/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Extra Notes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Stage B
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Stage B
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stageB/Stage_B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_2" >
        
          
          <label class="md-nav__link" for="__nav_3_4_2" id="__nav_3_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    TorsionBERT
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    TorsionBERT
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stageB/torsionBert/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stageB/torsionbert_code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stageB/torsionBert_full_paper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Paper
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Stage C
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Stage C
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stageC/Stage_C/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stageC/Integrated_RNA_Geometry_and_3D_Reconstruction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Geometry & Reconstruction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stageC/Unified, Comprehensive Plan for Integrating MP-NeRF into Stage C.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MP-NeRF Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stageC/mp_nerf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MP-NeRF Details
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" checked>
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Unified Latent
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Unified Latent
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Perceiver IO
  

    
  </span>
  
  

      </a>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Energy_Minimization_%26_Molecular_Dynamics_%28MD%29_for_RNA_Structure_Refinement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Energy & MD
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
        
          
          <label class="md-nav__link" for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Testing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Testing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../test_time_scaling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Time Scaling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_9" >
        
          
          <label class="md-nav__link" for="__nav_3_9" id="__nav_3_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Kaggle
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Kaggle
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kaggle_info/kaggle_competition/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Competition
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kaggle_info/M2_Plan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    M2 Plan
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Advanced Methods
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced Methods
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1_1" id="__nav_4_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    AlphaFold 3
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    AlphaFold 3
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/advanced_methods/af3/AF3_paper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Paper
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/advanced_methods/af3/AlphaFold3_progress/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Progress
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/advanced_methods/af3/Pairwise_Distance_Based_Prediction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distance Prediction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_2" >
        
          
          <label class="md-nav__link" for="__nav_4_1_2" id="__nav_4_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Diffusion
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Diffusion
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/advanced_methods/diffusion/s4_diffusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    S4 Diffusion
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/advanced_methods/diffusion/test_time_scaling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Time Scaling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/advanced_methods/isosteric_substitutions/RNA_isostericity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Isosteric Substitutions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    External Literature
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    External Literature
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/external_lit/2d_structure_prediction_papers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2D Structure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/external_lit/RNA_papers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RNA Papers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Residue Atom Bridging
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Residue Atom Bridging
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/residue_atom_bridging/audit_report/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Audit Report
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/residue_atom_bridging/design_spec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Design Spec
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/residue_atom_bridging/documentation_draft/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Documentation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/residue_atom_bridging/implementation_notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Implementation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/residue_atom_bridging/refactoring_plan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Refactoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/residue_atom_bridging/bridging_caveats_guidelines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Guidelines
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Torsion Calculations
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Torsion Calculations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/torsion_calculations/torsion_angles_intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/torsion_calculations/Standard_Bond_Lengths_and_Angles_in_RNA_Nucleotides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bond Lengths & Angles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/torsion_calculations/Torsion_Angles_3D_Coordinates_RNA_Structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3D Coordinates
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../reference/torsion_calculations/torsion_angle_Latent_Manifold_Representation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Latent Manifold
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<p></p>
<p>Perceiver IO: A General Architecture for Structured Inputs and Outputs</p>
<ol>
<li>Introduction and Core Motivation</li>
</ol>
<p>Perceiver IO (\text{Jaegle et al., ICLR 2022}) is a general-purpose neural network architecture designed to handle:
    1.  Arbitrary input modalitiesfrom images, text, and audio waveforms to multimodal combinations (video+audio, symbolic sets, etc.).
    2.  Arbitrary output structures, which can be as simple as a single class label or as complex as dense 2D/3D fields (optical flow, segmentation), multiscale audio waveforms, or sets of discrete symbolic tokens.</p>
<p>1.1 Why Another Architecture?</p>
<p>Many existing deep-learning systems are:
       Specialized: Different modules or entire networks are used for different tasks or data types (e.g., language vs. image).
       Scaling Bottlenecks: Transformers, while highly effective in language, typically scale quadratically (\mathcal{O}(T^2)) with the input length T. This becomes prohibitive for large images or raw audio waveforms without heavy preprocessing.
       Limited Output Flexibility: Even successful cross-domain architectures (like the original Perceiver) could only straightforwardly produce simple outputs (e.g., a single classification). More structured outputs (optical flow, entire waveforms) required specialized heads or specific design heuristics.</p>
<p>Goal: Perceiver IO aims to unify large-scale input handling (as in the original Perceiver) with the ability to generate large, structured outputs (IO stands for Input-Output), enabling a single model to do read-process-write for diverse tasks.</p>
<p></p>
<ol>
<li>Architectural Overview</li>
</ol>
<p>Perceiver IO builds on the original Perceiver (\text{Jaegle et al., 2021}) by introducing a flexible decoding mechanism for any output shape. Let us break down the three-stage process:
    1.  Encode (Cross-Attention Encoder)
       Inputs: We have an input array \mathbf{x} of shape M \times C. This might be (a) images converted into patches or RGB pixel embeddings; (b) text tokens or raw bytes; (c) audio waveforms, etc.
       Cross-Attention: The Perceiver IO maps these M inputs into a fixed-size latent array \mathbf{z} \in \mathbb{R}^{N \times D} via a cross-attention module. Crucially, N can be much smaller than M. This step effectively compresses large inputs into a manageable latent space.
    2.  Process (Latent Transformer / Latent Self-Attention)
       Having a fixed-size latent allows the network to perform multiple layers of Transformer-style self-attention with complexity \mathcal{O}(N^2), independent of the original input size M.
       This latent bottleneck is the heart of Perceiver-like approaches, as it decouples deep processing from input length.
    3.  Decode (Cross-Attention Decoder + Output Queries)
       The new Perceiver IO decoding mechanism uses output queries. For an output array of size O \times E, it constructs a set of O query vectors \mathbf{q}_1, \dots, \mathbf{q}_O.
       Each query attends to the latent array \mathbf{z} (via cross-attention again) to produce the output element \mathbf{y}_i.
       Why Queries? This design is highly flexible: you can produce a wide variety of outputsdense pixel maps, sequences of tokens, sets of symbolic units, or a single classificationall from the same latent space.</p>
<p>2.1 Internal Attention Modules</p>
<p>Each module follows a QKV (query-key-value) attention pattern plus a feed-forward MLP:
       Encoder: Key-Value (KV) inputs come from the high-dimensional input \mathbf{x}; queries (Q) come from the latent array.
       Processor: Self-attention among latent elements only (latent as both Q and KV).
       Decoder: Key-Value (KV) inputs come from the latent array; queries (Q) come from the learnable output queries.</p>
<p>2.2 Complexity and Scalability</p>
<p>A standard Transformer suffers \mathcal{O}(T^2) per layer. In Perceiver IO:
       Encode: \mathcal{O}(M \times N)
       Latent Self-Attention: \mathcal{O}(N^2 \times L) for L layers
       Decode: \mathcal{O}(O \times N)</p>
<p>Hence total \approx \mathcal{O}\bigl( (M + O) \times N + L \times N^2 \bigr), which is linear in input M and output O if N is chosen to be relatively small. This allows the model to handle very large inputs (e.g. raw text bytes up to length 2048) and large outputs (dense images, waveforms) with feasible memory and compute.</p>
<p></p>
<ol>
<li>Methodological Highlights</li>
</ol>
<p>3.1 Constructing Input Embeddings
       Raw Bytes (Text): Directly embed UTF-8 bytes (plus a few special tokens). Eliminates tokenization overhead and engineering of subword vocabularies.
       Patches or Convolution (Images, Video): For large images, one can patch or do a light convolution+pool to reduce dimensionality. Fourier features or learnable positional embeddings can be concatenated for positional cues.
       Multimodal Tagging: For tasks with multiple modalitiese.g. video + audioone can prepend or concatenate a small modality token so the model differentiates them.</p>
<p>3.2 Output Query Construction</p>
<p>A crucial novelty is how Perceiver IO decodes:
       Single-Query Classification: For classification tasks like ImageNet, we can have a single query embedding that attends to the latent and returns a single logit vector.
       Dense Queries: Optical flow or segmentation tasks can assign a query to each pixel or spatial location, typically encoding (x,y) coordinates. Each query then attends to the latent to produce the flow/label for that pixel.
       Multi-Task/Multimodal: Kinetics autoencoding might combine position embeddings (for frames or audio samples) plus a modality embedding that indicates whether we decode video, audio, or label.</p>
<p>3.3 Training and Subsampling of Outputs</p>
<p>When output dimension O is huge (e.g., hundreds of thousands of positions for high-resolution video+audio):
       Subsample the output queries during training: sample a subset of pixel/voxel locations or audio time steps each minibatch.
       Full Decoding can be done at inference, possibly in mini-batches of queries if memory is a concern.</p>
<p></p>
<ol>
<li>Experimental Evaluation</li>
</ol>
<p>Perceiver IO was tested across multiple domains, showcasing its generality:</p>
<p>4.1 Language (Masked Language Modeling and GLUE)
       Task: Train on a large text corpus (C4 + Wikipedia) with masked language modeling (MLM). Then fine-tune on GLUE (a standard NLP benchmark).
       Findings:
       UTF-8 Bytes: Perceiver IO can match or exceed BERT-like models on GLUE while directly processing raw bytes (no subword tokenization).
       Efficiency: Under the same FLOPs budget, the byte-level Perceiver IO outperforms a similarly de-tokenized BERT baseline by a substantial margin.
       Multitask Queries: A single Perceiver IO can handle multiple GLUE tasks by adopting separate query embeddings for each task, effectively replacing BERTs [CLS] token approach.</p>
<p>4.2 Optical Flow (Sintel, KITTI)
       Traditional Challenge: Optical flow typically relies on cost volumes or correlation for capturing large motions.
       Perceiver IO Approach:
    1.  Concatenate two consecutive frames along the channel dimension, possibly with 33 patches around each pixel plus (x,y) positional features.
    2.  Encode  Process in latent  Decode a flow vector for each pixels query.
       Results:
       SOTA Performance: Achieves near or better than state-of-the-art, outperforming RAFT (Teed &amp; Deng, 2020) and PWC-Net (Sun et al., 2018) on some benchmarks (e.g., Sintel.final).
       Surprising Generality: Succeeds without explicit multi-scale or correlation-volume modules, purely from learned cross-attention.</p>
<p>4.3 Multimodal Autoencoding (Kinetics-700)
       Setup: Input is raw video frames (16 frames at 224224) + raw audio (48kHz) + 700-class label. This is huge: ~800k input points if fully unrolled.
       Model:
       A single Perceiver IO compresses everything into the latent.
       Queries are built for each output position: e.g., video pixel positions, audio sample indices, class label queries.
       Findings:
       Can reconstruct (autoencode) the video, audio, and label from the latent representation.
       Showcases how modality tokens plus coordinate embeddings allow flexible bridging of multiple data streams.</p>
<p>4.4 Image Classification (ImageNet)
       Motivation: Validate that Perceiver IO is also effective for standard image classification.
       Performance:
       Reaches &gt;80% top-1 accuracy on ImageNet even without 2D convolutions or patch embedding, showing that the cross-attend decoding outperforms the older average+project approach.
       After large-scale pretraining (e.g., on JFT), the model surpasses 84% top-1.</p>
<p>4.5 Symbolic Outputs (StarCraft II via AlphaStar)
       AlphaStar: A high-profile RL system for StarCraft II uses a Transformer to encode sets of entities (e.g., units, buildings).
       Replacing the Transformer: Perceiver IO can directly substitute the entity encoder with minimal tuning, preserving the ~87% elite-bot win rate while reducing FLOPs by about 3.</p>
<p>4.6 AudioSet Classification
       Task: Classify 10s audio-video clips among 527 labels.
       Results: Perceiver IO slightly outperforms the original Perceivers average+project decoder, demonstrating that the attention-based decoder is beneficial even for simple classification tasks.</p>
<p></p>
<ol>
<li>Performance, Efficiency, and Complexity</li>
</ol>
<p>Key claim: Perceiver IO decouples the input and output dimensionalities from the deep processing. Once the data is in the latent, additional layers (depth L) only scale with N, the latent dimension. As a result:
       Large inputs (raw waveforms, 4K images) can be scaled more gracefully.
       Large or structured outputs (entire flow fields, entire waveforms) remain feasible: decoding is \mathcal{O}(O \times N), rather than \mathcal{O}(O^2).</p>
<p>5.1 Latent Size N Tuning</p>
<p>One important hyperparameter is the latent index dimension N.
       Trade-Off: Larger N can capture more detail in the latent representation but increases the cost of each self-attention layer.
       Practice: The authors typically choose moderate values like N=256 or N=512 in language tasks. For vision tasks, they sometimes go higher, e.g. N=1024, depending on hardware constraints.</p>
<p>5.2 Hardware Considerations
       TPU vs. GPU: Some experiments (like optical flow) show that Perceiver IO can be faster on TPUs than specialized methods, even if it may be slower on standard GPUs due to memory layouts in attention vs. specialized operations.</p>
<p></p>
<ol>
<li>Limitations and Considerations</li>
</ol>
<p>Despite its strengths, Perceiver IO has limitations worth keeping in mind:
    1.  Memory for Extremely Large Inputs
       While the complexity is linear in input size, you still need enough memory to hold \mathbf{x} in a single pass unless chunking or patch sampling is done. This can be challenging if M is extremely large (e.g., unrolled 4K video frames).
    2.  Output Subsampling for Training
       For tasks with massive output arrays (e.g., video reconstruction), the approach often subsamples the output queries during training. Full decoding is still linear but can become large in practice. This can complicate training or slow down inference for extremely dense tasks.
    3.  Latent Dimension Tuning
       The choice of N is a critical hyperparameter balancing representational capacity vs. compute. The correct value is somewhat task-dependent, so it may require iterative experimentation.
    4.  Domain-Specific Preprocessing
       In principle, Perceiver IO can handle raw signals. However, some tasks (especially large images or raw audio) still benefit from mild domain-aware steps (e.g. patching, short convolutions) to reduce the raw dimensionality or capture local structure before cross-attention.
    5.  Query Construction
       Designing robust query embeddings for complex tasks (especially multi-task or multimodal outputs) can require careful engineering or domain knowledge (e.g., coordinate embeddings, learned vs. Fourier positional encodings).
    6.  Model Size and FLOPs
       While the model can surpass specialized systems, it might have higher parameter counts or FLOPs if not carefully tuned. The theoretical linear efficiency is an advantage, but the constant factors in attention can still be large.</p>
<p></p>
<ol>
<li>Conclusion and Key Takeaways</li>
</ol>
<p>Perceiver IO is a scalable, flexible, and domain-agnostic neural architecture that:
    1.  Reads massive inputs (images, bytes, waveforms) into a modest latent bottleneck via cross-attention.
    2.  Processes the latent array using repeated self-attention that is independent of input and output sizes.
    3.  Writes arbitrary structured outputs via a powerful query-based decoding mechanism.</p>
<p>Empirical Results:
       Matches or exceeds specialized baselines on language (comparable to or better than BERT), optical flow (near or state-of-the-art on Sintel), ImageNet classification (&gt;80% top-1 without 2D assumptions), multi-modal tasks (audio+video), and discrete sets (StarCraft II).</p>
<p>Why It Matters:
       Unified Architecture: Reduces or removes the need for domain-specific trunk engineering.
       Linear Scaling: More friendly to large input/output tasks, both unimodal and multimodal.
       Structured Output Decoding: A powerful query-based approach that can unify tasks from classification to dense predictions.</p>
<p>Looking Ahead:
       Continued exploration of how to best handle extremely large inputs and outputs, including improved chunking strategies and dynamic query design.
       Enhanced theoretical understanding of how the latent bottleneck learns to represent diverse signals.
       Potential synergy with other token-free or domain-free methods (e.g. raw audio-linguistic training, 3D spatiotemporal tasks).</p>
<p></p>
<p>References to Key Points
       Jaegle et al. (2021): Original Perceiver approach.
       Transformers: Vaswani et al. (2017), BERT (Devlin et al., 2019).
       Comparable SOTA: Optical Flow (RAFT, PWCNet), ImageNet (ResNet, ViT), Language (BERT, Byte-based models).
       Multimodal: Kinetics, AudioSet, StarCraft II entity sets.</p>
<p></p>
<p>: This final document should provide a thorough technical understanding of the Perceiver IO framework. It integrates the advantages of detailed, step-by-step logic (like in V2), the extended coverage of specialized tasks and limitations (V1), and the concise structuring of major concepts (V3)all while addressing the criticisms regarding clarity, depth, and organization.</p>
<h1 id="emoji-if-you-have-further-questions-on-any-specific-domain-experiment-eg-details-on-optical-flow-ablations-or-the-precise-query-embeddings-in-kinetics-autoencoding-feel-free-to-ask-for-an-expanded-section">[emoji]: If you have further questions on any specific domain experiment (e.g., details on optical flow ablations or the precise query embeddings in Kinetics autoencoding), feel free to ask for an expanded section.</h1>
<p>Below is a comprehensive, bestofallworlds architectural design document that fuses the strengths of earlier versions (V1, V2, V3, and the previous Final references), while directly addressing the criticisms raisedparticularly about:
       Ensuring synergy between local (torsionbased) and global (pairwise) modules,
       Clarifying mandatory vs. optional pipeline components,
       Explaining how PerceiverIO (or a simpler miniTransformer/MLP) can serve as the Unified Latent Merger,
       Incorporating LoRA/QLoRA to keep memory usage manageable for large pretrained modules (TorsionBERT, Pairformer),
       Providing a robust endtoend strategy (including forward kinematics, energy minimization, multiloss training, etc.).</p>
<p>The result is a verbose, implementationoriented piece of technical documentation that should surpass the sum of its parts in clarity, depth, and synergy.</p>
<p></p>
<ol>
<li>High-Level Pipeline &amp; Goals</li>
</ol>
<p>1.1 Overall Objective</p>
<p>We want to predict RNA 3D coordinates from sequence data. We do so by:
    1.  Local Torsion Pipeline: TorsionBERT (or a similar BERT-like model) that outputs torsion angles for each residue, guided by adjacency (2D structure).
    2.  Global Pairwise Trunk: An AlphaFold3style Pairformer that ingests MSA or single-sequence input and adjacency signals to produce pair embeddings z_{ij} + single embeddings s_{i}.
    3.  Unified Latent Merger (ULM): Merges local angles + adjacency with global pair embeddings to yield a single conditioning latent. This is where we can use a small Transformer/MLP or a more advanced PerceiverIO approach.
    4.  Diffusion Module: Converts random/noisy coordinates (optionally partial from forward kinematics) into final 3D structure(s) using the merged latent.
    5.  (Optional) Forward Kinematics: If we want partial 3D warm starts from the torsion angles.
    6.  (Optional) Energy Minimization: A short postinference pass (e.g., local MD) to fix minor sterics or bond angles.
    7.  MultiLoss: Typically a final 3D RMSD/lDDT or distancebased loss for the Diffusion, plus an angle loss for TorsionBERT if you have torsion labels.</p>
<p>1.2 Why This Combined Architecture?
       Synergy: We dont want to lose adjacency or pair embeddings. Torsion angles alone are local, so we incorporate global pair constraints from the Pairformer.
       Flexibility: If N is large, the number of pair embeddings can be N^2. We must unify them efficiently. Thats where an advanced ULM, possibly PerceiverIO, helps.
       Memory Constraints: We partialfinetune only small LoRA adapters in TorsionBERT/Pairformer to keep GPU usage feasible.
       Accuracy: By combining local + global constraints in one final diffusion pass, we typically see improved 3D predictions over separate or optional merges.</p>
<p></p>
<ol>
<li>Mandatory vs. Optional Steps</li>
</ol>
<p>A key criticism of earlier versioned designs was the confusion around how many steps are truly needed vs. nice to have. Lets clarify:
    1.  Mandatory
       Torsion Pipeline (TorsionBERT + adjacency): We need local angles for synergy.
       Pairformer (AF3-like trunk): We need global pair constraints.
       Unified Latent: So the final 3D generator (Diffusion) sees both local + global embeddings.
       Diffusion: The main generative step for final 3D.
    2.  Strongly Recommended
       Energy Minimization: Even a short minimization helps fix steric or bondlength problems.
       Adjacency: TorsionBERT heavily relies on adjacency. If we skip adjacency, torsion predictions degrade.
    3.  Truly Optional
       Forward Kinematics: You can do partial 3D from angles (via MP-NeRF) if you want an initial conformation. If the torsion predictions are poor or if time is short, let the Diffusion handle from random noise.
       MSA: If multiple sequences exist, the Pairformers performance is improved. Otherwise, singlesequence mode is an option.
       Template: Some advanced workflows might feed partial 3D from external templates. Not mandatory.</p>
<p>By labeling these carefully, we ensure synergy isnt lost: local angles and global pair embeddings are always merged for the final 3D generation.</p>
<p></p>
<ol>
<li>Step-by-Step Technical Diagram</li>
</ol>
<p>Inputs &amp; Setup (sequence, adjacency, MSA, optional partial coords)
        
        v
(1) TorsionBERT (LoRA) &gt; (angles)
        
        (Optional) Forward Kinematics (partial 3D)
        
        &gt; (angles + adjacency + partial coords) ----
                                                        \
                               (2) Pairformer (LoRA) ---&gt; (z, s) 
                                                        /
                                                        
                (3) Unified Latent Merger (could be Perceiver IO or smaller subnetwork)
                                                        
                         (4) Diffusion (LoRA optional)  final 3D coords
                                                        
                  (5) Energy Minimization (Short MD)  polished final 3D</p>
<p></p>
<ol>
<li>Detailed Modules &amp; Where PerceiverIO Fits</li>
</ol>
<p>4.1 TorsionBERT + Adjacency
    1.  Input: RNA sequence (length N), plus adjacency from a 2D method (RFold, etc.).
    2.  Output: Torsion angles (\alpha, \beta, \ldots, \chi) for each residue, possibly sugar pucker.
    3.  LoRA: We freeze the large pretrained BERT backbone and add ranklimited LoRA adapters in its attention or feedforward layers. This drastically reduces trainable parameters.</p>
<p>Indexing: Keep a consistent residue list from 0..N1. If adjacency includes base pairs, we store them in a matrix or dictionary. The TorsionBERT final heads produce angles in the correct order.</p>
<p>4.2 Pairformer (AlphaFold3Style)
    1.  Input:
       Possibly an MSA, or a single sequence if MSA is unavailable.
       Optional adjacency as a bias (like a logit shift or an embedding factor).
    2.  Trunk: ~48 blocks of triangular attention, pair updates, etc.
    3.  Output: A pair embedding \mathbf{z}_{ij} (dimension pair_dim) for each residue pair (i,j), plus single embeddings \mathbf{s}_i.
    4.  LoRA: Freeze the main trunk and insert LoRA. This partial finetuning approach keeps memory usage feasible.</p>
<p>4.3 (Optional) Forward Kinematics
       If used, we feed the TorsionBERT angles into a differentiable NeRF approach to get partial 3D.
       This partial conformation can help the Diffusion start from something less random.
       If angles are inaccurate, it might hamper the pipeline, so we can skip it and let Diffusion do the entire 3D from scratch.</p>
<p>4.4 Unified Latent Merger (ULM)</p>
<p>Core Step: merges local angles + adjacency + partial coords with global pair embeddings.
       Standard Approach:
       A small MLP or miniTransformer that ingests nodelevel angles, adjacency info, plus pairlevel \mathbf{z}<em ij="ij">{ij}. Output: a single latent array or conditioning vector.
       Advanced Approach: PerceiverIO
       If \mathbf{z}</em>(N^4)).
       PerceiverIO uses crossattention to read many tokens (angles, adjacency, pair embeddings) into a smaller latent dimension N{\prime}. Then repeated selfattention is only \mathcal{O}(N{\prime}^2). Finally, decode (O queries) to produce the final synergy vector.
       Pro: Great for scaling to large RNA or complex embeddings, easily merges multiple modalities.
       Con: More code complexity than a small MLP. Overkill for very small N.} is large (like N^2 for big RNAs), a naive Transformer might blow up in memory (\mathcal{O</p>
<p>Hence, if your pipeline must unify large pair embeddings or you anticipate adding new constraints (like partial templates, more adjacency data), PerceiverIO is strongly recommended for synergy.</p>
<p>4.5 Diffusion
    1.  Goal: Denoise random/noisy coords (or partial coords) into final 3D.
    2.  Conditioning: The unified latent from step (4.4). Possibly fed at each diffusion step or used as an initial context.
    3.  LoRA: If the Diffusion model is large (like a 3D UNet or Transformer), freeze base weights, add LoRA. If its moderate sized, you can train fully.
    4.  Output: final 3D coordinates. Because its generative, we can sample multiple times for an ensemble.</p>
<p>4.6 Energy Minimization
    1.  Implementation: short local MD or partial minimization (Amber, CHARMM, etc.).
    2.  No gradient: Typically outside the endtoend backprop.
    3.  Ensemble: Evaluate ~510 diffusion samples. Minimization might fix small sterics. Choose the top structure(s) by geometry score or some model confidence metric.</p>
<p></p>
<ol>
<li>MultiLoss Training &amp; Backprop</li>
</ol>
<p>Because we have multiple submodules, each with partial or full finetuning, we define multiobjective losses:
    1.  Angle Loss \mathcal{L}<em 3D="3D">{\mathrm{angle}}:
       If you have groundtruth angles, you can match TorsionBERTs outputs to those angles (circular MSE, for example).
       Directly updates TorsionBERT LoRA parameters.
    2.  3D Loss \mathcal{L}</em>:
       Compare final 3D from Diffusion to known 3D structure. RMSD, lDDT, or FAPE are common.
       Grad flows through the Diffusion  Unified Merger  Pairformer (LoRA) + TorsionBERT (LoRA).
    3.  (Optional) Pair Distogram Loss \mathcal{L}_{\mathrm{pair}}:
       If you have distance or contact data, you can partially train the Pairformer trunk. Only LoRA layers are updated.</p>
<p>Final Weighted Loss:
\mathcal{L}{\text{total}}
= \lambda{3D}\,\mathcal{L}<em _mathrm_angle="\mathrm{angle">{3D}
       \lambda</em>}}\,\mathcal{L<em _mathrm_pair="\mathrm{pair">{\mathrm{angle}}
       \lambda</em>
       \dots}}\,\mathcal{L}_{\mathrm{pair}</p>
<p>Validation:
       Angle metrics: average angle error, sugar pucker accuracy.
       Pair metrics: contact precision, distogram KL, etc.
       Final 3D metrics: RMSD, GDT, lDDT, or specialized RNA geometry checks (like basepair RMSD).</p>
<p></p>
<ol>
<li>LoRA / QLoRA for Partial Finetuning</li>
</ol>
<p>Key to memory feasibility: TorsionBERT or Pairformer can each have \sim!!10^8 parameters. We do:
    1.  Load Pretrained base model (frozen).
    2.  Wrap with LoRA: Insert lowrank adapter matrices in the attention or feedforward layers (e.g., HF PEFT library).
    3.  Train only LoRA adapter weights + newly introduced heads (like angle heads in TorsionBERT).</p>
<p>Implementation:</p>
<p>from peft import LoraConfig, get_peft_model</p>
<p>lora_cfg = LoraConfig(
    r=8,
    lora_alpha=32,
    target_modules=["q_proj", "v_proj", "fc1", "fc2"], # example
    ...
)
torsion_bert_lora = get_peft_model(pretrained_torsionBert, lora_cfg)</p>
<p>Then only these adapter parameters get requires_grad=True. The rest remain frozen, drastically cutting memory usage.
       QLoRA: If extremely large, quantize the base to 8bit or 4bit, keep LoRA in higher precision.</p>
<p>Which Modules:
       TorsionBERT: Typically we adapt a few layers, or the entire selfattention stack (with rank=8 or so).
       Pairformer: Similarly, insert LoRA in triangular attention blocks.
       Diffusion: Optional if the diffusion network is large or if you have a partial pretrained model.</p>
<p>Result: an endtoend differentiable pipeline, but only a small fraction of total weights is updated.</p>
<p></p>
<ol>
<li>Putting It All Together: Implementation Roadmap</li>
</ol>
<p>Below is a unified approach that merges the synergy arguments from earlier versions (V1, V2) with the memory/LoRA details (V3) and clarifications from the final pipeline descriptions:</p>
<p>7.1 Data Preprocessing
    1.  Obtain Adjacency (2D) from a method like RFold.
    2.  Create MSA if you have multiple sequences. If not, single sequence is okay.
    3.  Residue Index: define a stable 0..N1 labeling so TorsionBERT and Pairformer see the same residue ordering.</p>
<p>7.2 Torsion Pipeline (TorsionBERT + LoRA)</p>
<h1 id="pseudocode">Pseudocode</h1>
<p>torsion_bert_base = load_pretrained_torsion_bert(...)
torsion_bert_lora = wrap_with_LoRA(torsion_bert_base, config)</p>
<div class="highlight"><pre><span></span><code>   Forward: angles = torsion_bert_lora(sequence, adjacency).
   Possibly define angle_loss = circular_mse(angles, angles_gt) if we have angle data.
</code></pre></div>
<p>7.3 (Optional) Forward Kinematics (MP-NeRF)</p>
<p>if use_fk:
    partial_coords = mp_nerf(angles)
else:
    partial_coords = None</p>
<div class="highlight"><pre><span></span><code>   If used, partial_coords is a differentiable function of angles.
</code></pre></div>
<p>7.4 Pairformer (AlphaFold3Style + LoRA)</p>
<p>pairformer_base = load_af3_like_trunk(...)
pairformer_lora = wrap_with_LoRA(pairformer_base, config)</p>
<p>z_ij, s_i = pairformer_lora(MSA or single_seq, adjacency=adjacency?)</p>
<div class="highlight"><pre><span></span><code>   Grad from final 3D or pair constraints can update only LoRA weights.
</code></pre></div>
<p>7.5 Unified Latent Merger</p>
<p>Option A: Small Transformer or MLP merges
{\text{angles}, \text{adjacency}, \partial\text{coords}} with {z_{ij}, s_i}.</p>
<p>Option B: PerceiverIO for large data:
    1.  Flatten \mathbf{z}_{ij} + angles + partial coords into M tokens, each tagged with type embeddings or (i,j) coordinate embeddings.
    2.  Crossattend them once to a smaller latent dimension N{\prime}.
    3.  Selfattention for L layers on that latent.
    4.  Crossattend from O queries to produce the final synergy vector.</p>
<p>In either approach, we get a final merged latent that the diffusion sees.</p>
<p>7.6 Diffusion (LoRA optional)</p>
<p>diffusion_net = load_diffusion_model(...) # could also do from scratch
if large:
    diffusion_lora = wrap_with_LoRA(diffusion_net, config)</p>
<p>final_3D = diffusion_lora(noisy_init, merged_latent)</p>
<div class="highlight"><pre><span></span><code>   We do a standard diffusion loss or direct RMSD at the final step.
</code></pre></div>
<p>7.7 Energy Minimization</p>
<p>For each final 3D structure from diffusion:
    1.  Run a short local MD or partial minimization.
    2.  Evaluate geometry or an internal rank metric.
    3.  Keep top structure(s).</p>
<p></p>
<ol>
<li>Example Training Loop (EndtoEnd)</li>
</ol>
<p>def forward_pipeline(seq, adjacency, MSA, coords_gt=None, angles_gt=None):
    # 1) Torsion angles
    torsion_angles = torsion_bert_lora(seq, adjacency)</p>
<div class="highlight"><pre><span></span><code># Possibly partial coords
partial_coords = mp_nerf(torsion_angles) if use_fk else None

# 2) Pair embeddings
z_ij, s_i = pairformer_lora(MSA or seq, adjacency=adjacency)

# 3) Merge
unified_latent = unify_latent(torsion_angles, adjacency, partial_coords, z_ij, s_i)

# 4) Diffusion
final_3D = diffusion_model(unified_latent)

# Compute losses
losses = {}
if angles_gt is not None:
    losses[&quot;angle_loss&quot;] = angle_loss_fn(torsion_angles, angles_gt)
if coords_gt is not None:
    losses[&quot;3D_loss&quot;] = coordinate_loss(final_3D, coords_gt)
return final_3D, losses
</code></pre></div>
<p>optimizer = ...
for batch in dataloader:
    seq, adjacency, coords_gt, angles_gt, MSA = batch
    final_coords, loss_dict = forward_pipeline(seq, adjacency, MSA, coords_gt, angles_gt)</p>
<div class="highlight"><pre><span></span><code>total_loss = (lambda_angles * loss_dict.get(&quot;angle_loss&quot;, 0.0)
             + lambda_3D * loss_dict.get(&quot;3D_loss&quot;, 0.0))
total_loss.backward()
optimizer.step()
optimizer.zero_grad()
</code></pre></div>
<p>Memory:
       Because TorsionBERT, Pairformer, (optionally) Diffusion are mostly frozen with small LoRA adapters, we only store gradient states for those lowrank parameters, drastically reducing GPU usage.</p>
<p></p>
<ol>
<li>Addressing Criticisms &amp; Strengths Over Previous Versions<ol>
<li>No lost synergy:
   Torsion angles + Pair embeddings are mandatory. We do not allow skipping either. They unify in a single latent.</li>
<li>Clarity on optional:
   We label forward kin and MSA as truly optional, so its not a confusion of some synergy might be lost.</li>
<li>Improved Merging:
   We mention a purposeful Unified Latent Merger that can be PerceiverIO if data is large or a simpler subnetwork if data is smaller.</li>
<li>LoRA:
   We detail how partial finetuning is inserted into TorsionBERT + Pairformer (and possibly Diffusion), addressing memory constraints.</li>
<li>Energy Minimization:
   Shown as recommended, clarifying its a final, nondifferentiable step for geometry polishing.</li>
</ol>
</li>
</ol>
<p>Overall, we unify the synergy arguments and the partial finetuning approach into a single pipeline, ensuring final 3D coordinate generation truly leverages local angles and global pair constraints.</p>
<p></p>
<ol>
<li>Conclusion &amp; Best Practices<ol>
<li>EndtoEnd Flow:
   Start from sequence + adjacency  TorsionBERT angles (LoRA)  Pairformer embeddings (LoRA)  merge them  final Diffusion (LoRA)  optional minimization.</li>
<li>LoRA:
   Paramount for large pretrained modules. Freed memory can be used for bigger batch sizes or deeper merges (like Perceiver IO).</li>
<li>PerceiverIO in the Merger**:
   Ideal if you have large N or you want a single domainagnostic architecture to unify angles, adjacency, partial coords, pair embeddings.
   Flatten everything, crossattend once, process in a small latent dimension, decode final synergy vector.
   Implementation overhead is higher; for smaller N or simpler merges, a small MLP might suffice.</li>
<li>Loss Weights:
   Typically emphasize \mathcal{L}{3D}. If you have good angle supervision, add \mathcal{L}{\text{angle}}. Possibly incorporate contact constraints.</li>
<li>Energy Minimization &amp; Ensemble:
   Running a short local minimization for each predicted structure can fix tiny geometry issues. Then you can rank multiple final structures to pick the best.</li>
</ol>
</li>
</ol>
<p>Final Word</p>
<p>By following this comprehensive design, you harness both local angle constraints (TorsionBERT) and global pair embeddings (Pairformer) in an endtoend trainable frameworkkept memoryefficient via LoRA. The Unified Latent Merger step ensures synergy; if the embeddings are large, PerceiverIO is an excellent advanced approach to unify them. The pipeline concludes with a Diffusion generator for final 3D and an Energy Minimization pass, typically producing highfidelity, physically consistent RNA structures that significantly improve over smaller or partial versioned designs.</p>
<p>This final document:
       Builds on the synergy arguments of V1/V2,
       Includes the LoRA/QLoRA partial finetuning details from V3,
       Clarifies optional vs. mandatory steps (a major critique in earlier versions),
       Incorporates the robust final design pipeline from the prior V4 references,
       And more explicitly enumerates how or why to adopt PerceiverIO if data is large, fulfilling the best-ofallworlds criteria while surpassing the partial designs in both thoroughness and clarity.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>